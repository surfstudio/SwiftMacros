# Конвенция имен
**Имена функций**
Название функции должно начинаться с:
- `get`, если функция возвращает что-то из `node` или `context` (входные параметры макроса)
```swift
let input closure = getInputClosure(from node)
```
- `create`, если функция создает и возвращает новый синтаксический элемент
```swift
let router = createRouterVariable()
```

**Имена переменных**
- при создании экземпляра `TokenSyntax` не стоит писать `Token` в названии переменной, лучше укажите, что будет хранить переменная.
```swift
let structName = TokenSyntax(.identifier("MyStruct"))
```

**Общие рекомендации**
- не добавляйте `syntax` в название. В контексте макроса и так понятно, что работа происходит с синтаксическими элементами.
- в начале структуры объявите `enum Names` для хранения констант-имен, используемых в макросе (аналог `enum Constants` от мира макросов)
```swift
struct MyMacro: DeclarationMacro {

    // MARK: - Names

    private enum Names {
        static let variable = "count"
    }

    // MARK: - Macro
    ...
}
```

# Советы по разработке
## TDD
Производить отладку макросов достаточно сложно (палки в колеса иногда вставляет сам Xcode), ошибки не всегда понятны, поэтому советуем попробовать TDD подход в написании нового макроса. При использовании тестов также появится возможность работать с дебаггером, посмотреть синтаксическое дерево и тд.
- Используйте синтаксические деревья
Фреймворк `SwiftSyntax` содержит в себе большое количество типов, используемых в языке. Для снижения порога вхождения предлагается использовать синтаксические деревья - структура данных типа дерево, в которой хранится распарсенный код в виде объектов `SwiftSyntax`.
Есть 2 варината, как посмотреть на дерево вашего кода:
- написать тест, поставить breakpoint, вывести node в консоль через `po node`
- воспользоваться (сайтом)[https://swift-ast-explorer.com], где необходимо просто напечатать интересующий вас код

# Иногда ~~часто~~ Xcode это больно
Поскольку доступ к макросам появился относительно недавно, встречаются странности в поведении IDE. Могут проходить тесты, но Xcode будет говорить, что с вашим макросом что-то не так, или макрос будет не раскрываться по непонятным причинам, или ...
Пока ожидаете новые обновления, исправляющие баги, можете попробовать следующие варианты для лечения Xcode:
- запускать build через консоль
- закрыть/открыть Xcode
- использовать макрос в реальном проекте, а не в `main.swift`
